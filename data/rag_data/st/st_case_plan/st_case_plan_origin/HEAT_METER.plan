{"variables": [], "instructions": [], "planning": "- 概述\n这段代码是一个使用SCL编写的功能块，名为“HEAT_METER”，用于计算热量。它根据输入的温度、流量等参数计算热量，并输出结果。功能块还支持脉冲模式和平均时间计算。\n\n- 变量定义\n代码中定义了以下几类变量：\n - 输入变量：温度前（TF）、温度后（TR）、流量（LPH）、使能（E）、复位（RST）、比热容（CP）、密度（Density）、含量（Content）、脉冲模式（Pulse_Mode）、返回表（Return_meter）、平均时间（AVG_time）\n - 输出变量：热量（C）\n - 输入输出变量：热量累计值（Y）\n - 内部变量：时间戳（tx）、上次时间戳（last）、积分器（int1）、边缘检测（edge）、热量计算中间值（x）、初始化标志（init）、上次热量累计值（y_last）\n\n- 主逻辑部分\n-- REGION 复位逻辑\n   如果复位信号（RST）为真，则复位积分器（int1），并清零热量输出（C）和热量累计值（Y）。复位完成后，复位信号被清除。\n-- REGION 热量计算\n   如果使能信号（E）为真，则根据输入的温度、流量、比热容、密度和含量计算热量中间值（X）。计算公式考虑了水的密度、焓值以及比热容和密度的贡献。\n-- REGION 积分器逻辑\n   如果脉冲模式（Pulse_Mode）为假且使能信号（E）为真，则使用积分器（int1）对热量中间值（X）进行积分，并将结果赋值给热量累计值（Y）。如果脉冲模式为真，则在使能信号的上升沿将热量中间值（X）乘以流量（LPH）并累加到热量累计值（Y）。\n-- REGION 边缘检测\n   使用边缘检测变量（edge）来记录使能信号（E）的状态变化。\n-- REGION 时间戳处理\n   获取当前时间戳（tx）并检查是否初始化。如果未初始化，则初始化时间戳（last）。如果当前时间戳与上次时间戳的差值大于或等于平均时间（AVG_time），则更新上次时间戳（last），并计算平均热量输出（C）。计算公式考虑了热量累计值（Y）的变化和平均时间。\n-- REGION 输出更新\n   根据计算结果更新热量输出（C）和热量累计值（Y）。\n\nEND_FUNCTION_BLOCK", "name": "HEAT_METER"}