{"variables": [], "instructions": [], "planning": "- 概述\n  该功能块 `_RMP_B` 用于实现斜坡函数（Ramp Function），根据输入的方向 `DIR` 和时间参数 `TR`，逐步改变输出 `RMP` 的值。功能块的核心逻辑是根据时间参数 `TR` 和当前时间，计算 `RMP` 的当前值，并确保斜坡过程的平滑性。\n\n- 变量定义\n  代码中定义了以下几类变量：\n  - 输入变量：`DIR`（方向，`TRUE` 表示向上，`FALSE` 表示向下）、`E`（使能信号，默认为 `TRUE`）、`TR`（斜坡时间）。\n  - 输入输出变量：`RMP`（斜坡输出值，类型为 `BYTE`）。\n  - 内部变量：`tx`（当前时间）、`tl`（上次记录的时间）、`tn`（斜坡时间）、`init`（初始化标志）、`last_dir`（上一次的方向）、`start`（斜坡起始值）。\n\n- 主逻辑部分\n  -- REGION 主逻辑：\n    功能块的核心逻辑分为两个部分：\n    1. **斜坡计算**：\n       - 首先获取当前时间 `tx`，并将其转换为 `TIME` 类型。\n       - 如果使能信号 `E` 为 `TRUE`，且初始化标志 `init` 为 `TRUE`，且当前方向 `DIR` 与上一次方向 `last_dir` 相同，且当前输出 `RMP` 未达到目标值（`SEL(DIR, 0, 255)`），且斜坡时间 `TR` 等于 `tn`，则调用 `FRMP_B` 函数计算新的 `RMP` 值。\n       - `FRMP_B` 函数的参数包括起始值 `start`、方向 `DIR`、经过的时间 `tx - tl` 和斜坡时间 `TR`。\n    2. **初始化与重置**：\n       - 如果上述条件不满足，则执行初始化操作：\n         - 将 `init` 设置为 `TRUE`，表示已完成初始化。\n         - 记录当前时间 `tx` 为 `tl`，用于下一次计算。\n         - 将斜坡时间 `TR` 赋值给 `tn`，用于后续比较。\n         - 将当前 `RMP` 值记录为 `start`，作为斜坡的起始值。\n    3. **方向更新**：\n       - 最后，将当前方向 `DIR` 记录到 `last_dir`，用于下一次比较。\n\n- 输出结果\n  - 输出 `RMP` 的值会根据斜坡时间 `TR` 和方向 `DIR` 逐步变化。如果方向为 `TRUE`，`RMP` 会从当前值逐步增加到 `255`；如果方向为 `FALSE`，`RMP` 会从当前值逐步减少到 `0`。\n  - 斜坡过程的平滑性通过时间参数 `TR` 控制，确保 `RMP` 的变化在指定时间内完成。\n\n- 关键点\n  - **斜坡时间 `TR`**：控制 `RMP` 从起始值到目标值的变化时间。\n  - **方向 `DIR`**：决定 `RMP` 是增加还是减少。\n  - **初始化标志 `init`**：确保斜坡过程从正确的起始值开始。\n  - **时间记录 `tx` 和 `tl`**：用于计算斜坡过程中经过的时间，确保斜坡的平滑性。", "name": "_RMP_B"}