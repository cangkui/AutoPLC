{"variables": [], "instructions": [], "planning": "- 概述\n该功能块 `FILTER_W` 实现了一个简单的滤波器，用于平滑输入信号 `X` 的变化。它通过时间常数 `T` 来控制输出信号 `Y` 的变化速度，确保 `Y` 不会突然跟随 `X` 的变化，而是逐步接近 `X`。该滤波器适用于需要平滑处理信号的应用场景，例如传感器数据滤波或控制系统的信号处理。\n\n- 变量定义\n代码中定义了以下几类变量：\n  - 输入变量：`X` 是输入信号，`T` 是滤波器的时间常数，表示滤波器的响应速度。\n  - 输出变量：`Y` 是滤波后的输出信号。\n  - 内部变量：\n    - `last`：存储上一次处理的时间戳。\n    - `tx`：存储当前的时间戳。\n    - `init`：初始化标志，用于标识滤波器是否已经初始化。\n    - `tmp`：临时变量，用于存储计算过程中的中间值。\n\n- 主逻辑部分\n  -- REGION 初始化逻辑：\n     - 如果 `init` 为 `FALSE`（表示第一次运行）或者时间常数 `T` 为 `T#0s`（表示不需要滤波），则进行初始化。\n     - 将 `init` 设置为 `TRUE`，表示滤波器已经初始化。\n     - 将 `last` 设置为当前时间戳 `tx`。\n     - 将输出 `Y` 直接设置为输入 `X`，表示没有滤波效果。\n  \n  -- REGION 输入不变逻辑：\n     - 如果输出 `Y` 等于输入 `X`，表示输入信号没有变化。\n     - 将 `last` 更新为当前时间戳 `tx`，以记录当前时间。\n\n  -- REGION 输入变化逻辑：\n     - 如果输出 `Y` 不等于输入 `X`，表示输入信号发生了变化。\n     - 计算变化量 `tmp`，公式为：`tmp = (X - Y) * (tx - last) / T`。\n       - `(X - Y)` 是输入与输出的差值。\n       - `(tx - last)` 是当前时间与上一次处理时间的差值。\n       - `T` 是时间常数，用于控制滤波速度。\n     - 如果 `tmp` 不为零，则将 `Y` 更新为 `Y + tmp`，表示输出信号逐步接近输入信号。\n     - 将 `last` 更新为当前时间戳 `tx`，以记录当前时间。\n\n- 输出结果\n滤波器的输出 `Y` 会根据输入 `X` 的变化逐步调整，调整速度由时间常数 `T` 控制。如果 `T` 较大，则 `Y` 的变化较慢；如果 `T` 较小，则 `Y` 的变化较快。当 `T` 为 `T#0s` 时，滤波器被禁用，`Y` 直接等于 `X`。\n\n- 关键点\n  - 滤波器通过时间常数 `T` 控制输出信号的变化速度，避免输出信号突变。\n  - 使用时间戳 `tx` 和 `last` 来计算时间间隔，确保滤波器的动态性能。\n  - 初始化逻辑确保滤波器在第一次运行时能够正确启动。\n  - 当输入信号不变时，滤波器不会进行不必要的计算，提高了效率。", "name": "FILTER_W"}