{"variables": [], "instructions": [], "planning": "- 概述\n这段代码实现了一个比例积分（PI）控制器功能块，名为`FT_PIWL`。它根据输入信号`IN`和比例积分参数`KP`、`KI`，计算输出`Y`，并限制输出在`LIM_L`和`LIM_H`之间。此外，它还提供了输出是否达到限制的标志`LIM`。\n\n- 变量定义\n代码中定义了以下几类变量：\n - 输入变量：`IN`（输入信号）、`KP`（比例增益）、`KI`（积分增益）、`LIM_L`（下限）、`LIM_H`（上限）、`RST`（复位信号）。\n - 输出变量：`Y`（输出信号）、`LIM`（输出是否达到限制的标志）。\n - 内部变量：`init`（初始化标志）、`tx`（当前时间戳）、`tc`（时间差）、`t_last`（上一次时间戳）、`in_last`（上一次输入值）、`i`（积分项）、`p`（比例项）。\n\n- 主逻辑部分\n-- REGION 初始化和复位\n   此区域处理功能块的初始化和复位逻辑。如果`init`为假或`RST`为真，则执行初始化操作。初始化包括：\n   - 设置`init`为真。\n   - 将`in_last`设置为当前输入值`IN`。\n   - 获取当前时间戳并存储在`t_last`中。\n   - 将积分项`i`和时间差`tc`重置为0.0。\n\n-- REGION 时间差计算\n   此区域计算当前时间与上一次时间的时间差`tc`：\n   - 获取当前时间戳并存储在`tx`中。\n   - 计算时间差`tc`，即`tx - t_last`，并将其转换为`REAL`类型。\n   - 更新`t_last`为当前时间戳`tx`。\n\n-- REGION 比例项计算\n   此区域计算比例项`p`：\n   - 比例项`p`等于`KP`乘以当前输入`IN`。\n\n-- REGION 积分项计算\n   此区域计算积分项`i`：\n   - 积分项`i`等于`(IN + in_last) * 5.0E-7 * KI * tc + i`，其中`5.0E-7`是一个缩放因子。\n   - 更新`in_last`为当前输入`IN`。\n\n-- REGION 输出计算和限制\n   此区域计算输出`Y`并检查是否超出限制：\n   - 输出`Y`等于比例项`p`加上积分项`i`。\n   - 如果`Y`大于等于`LIM_H`，则将`Y`限制为`LIM_H`，并根据`KI`的值调整积分项`i`，同时将`LIM`设置为真。\n   - 如果`Y`小于等于`LIM_L`，则将`Y`限制为`LIM_L`，并根据`KI`的值调整积分项`i`，同时将`LIM`设置为真。\n   - 如果`Y`在`LIM_L`和`LIM_H`之间，则将`LIM`设置为假。\n\n-- REGION 结束\n   此区域结束功能块的执行。", "name": "FT_PIWL"}