{"variables": [], "instructions": [], "planning": "- 概述\n此函数名为`FSTRING_TO_WEEKDAY`，用于将表示星期几的字符串转换为对应的整数值。函数支持多语言处理，并根据输入的语言参数选择合适的语言资源进行比较。\n\n- 变量定义\n代码中定义了以下几类变量：\n - 输入变量：`WDAY`（表示星期几的字符串），`LANG`（语言代码）。\n - 内部变量：`tmp`（临时存储处理后的字符串），`i`（循环计数器），`ly`（实际使用的语言代码）。\n\n- 主逻辑部分\n-- REGION 语言选择\n   函数首先根据输入的语言参数`LANG`选择合适的语言资源。如果`LANG`为0，则使用默认语言；否则，使用`LANG`和最大语言代码`LANGUAGE.LMAX`中的较小值。这是为了确保语言代码在有效范围内。\n\n-- REGION 字符串处理\n   接下来，函数对输入的字符串`WDAY`进行处理：\n   - 使用`TRIM`函数去除字符串两端的空格。\n   - 使用`LOWERCASE`将字符串转换为小写，然后使用`CAPITALIZE`将首字母大写。这种处理方式确保字符串的格式与语言资源中的格式一致。\n\n-- REGION 星期匹配\n   函数通过一个循环遍历1到7（表示星期一到星期日），将处理后的字符串`tmp`与语言资源`language.WEEKDAYS2`中的对应项进行比较。如果找到匹配项，则返回对应的整数值`i`。\n\n-- REGION 默认处理\n   如果循环结束后仍未找到匹配项，函数将尝试将输入字符串`WDAY`直接转换为整数并返回。这是一种后备机制，用于处理无法匹配的情况。\n\n- 输出结果\n函数的返回值是一个整数，表示星期几。如果成功匹配，则返回1到7之间的值；否则，返回将字符串转换为整数的结果。", "name": "FSTRING_TO_WEEKDAY"}