{"variables": [], "instructions": [], "planning": "- 概述\n这段代码实现了一个一阶惯性环节（PT1）功能块，用于模拟一阶系统的动态响应。该功能块根据输入信号、时间常数和增益，计算输出信号。它通过时间积分的方式逐步逼近稳态值，模拟一阶系统的特性。\n\n- 变量定义\n代码中定义了以下几类变量：\n  - 输入变量：`in`（输入信号）、`T`（时间常数）、`K`（增益，默认值为1.0）。\n  - 输出变量：`out`（输出信号）。\n  - 内部变量：`last`（上一次调用的时间戳）、`tx`（当前时间戳）、`init`（初始化标志，用于首次调用时的特殊处理）。\n\n- 主逻辑部分\n  -- REGION 主逻辑：\n    1. **获取当前时间**：使用`T_PLC_US()`函数获取当前PLC的微秒时间戳，并存储在`tx`变量中。\n    2. **初始化处理**：\n       - 如果功能块是首次调用（`init`为`FALSE`）或时间常数`T`为0，则进行初始化：\n         - 将`init`设置为`TRUE`，表示初始化完成。\n         - 直接计算输出值：`out = K * in`，即输出等于输入乘以增益。\n    3. **动态响应计算**：\n       - 如果功能块已经初始化且时间常数`T`不为0，则根据一阶惯性环节的动态特性计算输出值：\n         - 公式：`out = out + (in * K - out) * (Tx - last) / TIME_TO_REAL(T) * 1.0E-3`\n         - 其中，`(Tx - last)`表示两次调用之间的时间差，`TIME_TO_REAL(T)`将时间常数转换为实数。\n         - 该公式通过时间积分的方式逐步逼近稳态值，模拟一阶系统的动态响应。\n    4. **输出值修正**：\n       - 如果输出值的绝对值小于`1.0E-20`，则将其设置为0，避免浮点数精度问题。\n    5. **更新时间戳**：\n       - 将当前时间戳`tx`存储在`last`变量中，用于下一次调用的时间差计算。\n\n- 总结\n该功能块通过一阶惯性环节的动态响应公式，模拟了一阶系统的特性。它支持首次调用的初始化处理，并根据时间常数和增益逐步逼近稳态值。输出值的计算考虑了时间差和浮点数精度问题，确保了计算的准确性和稳定性。", "name": "FT_PT1"}