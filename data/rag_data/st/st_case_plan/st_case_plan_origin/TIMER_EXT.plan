{"variables": [], "instructions": [], "planning": "- 概述\n  这是一个扩展的定时器功能块（TIMER_EXT），用于根据多种条件（如时间、日出日落、节假日等）控制输出信号。它结合了手动控制、去抖动逻辑和时间条件判断，适用于复杂的定时控制场景。\n\n- 变量定义\n  代码中定义了以下几类变量：\n  - 输入变量：使能、启动、停止、手动控制、开关、日期时间输入、日出时间、日落时间、节假日标志、去抖动时间、日出开始时间、日出停止时间、日落开始时间、日落停止时间、每日开始时间、每日停止时间、启用周六、启用周日、启用节假日。\n  - 输出变量：输出信号、状态。\n  - 内部变量：手动控制模块、去抖动模块、当前时间、星期几、时间差、时间戳、上次时间戳、临时输出、初始化标志。\n\n- 主逻辑部分\n  -- REGION 初始化\n     首先，将日出和日落时间转换为毫秒精度。然后，获取当前时间戳并进行初始化。如果未初始化，则设置上次时间戳为当前时间戳，并计算时间差。如果时间差小于200ms，则直接返回，避免频繁处理。\n\n  -- REGION 去抖动处理\n     使用去抖动模块处理开关输入，确保信号稳定。去抖动时间由输入参数`T_DEBOUNCE`控制。\n\n  -- REGION 时间与日期处理\n     将输入的日期时间转换为时间格式，并获取当前星期几。\n\n  -- REGION 条件判断与输出控制\n     根据去抖动模块的输出、节假日标志、星期几、每日开始/停止时间、日出/日落时间等条件，判断是否应输出信号。具体逻辑如下：\n     - 如果去抖动模块输出为真，则切换临时输出，并设置状态为110。\n     - 如果节假日标志为真且未启用节假日，则临时输出为假。\n     - 如果当前是周六且未启用周六，则临时输出为假。\n     - 如果当前是周日且未启用周日，则临时输出为假。\n     - 如果每日开始时间大于00:00且当前时间减去每日开始时间小于等于时间差，则临时输出为真，并设置状态为111。\n     - 如果每日停止时间大于00:00且当前时间减去每日停止时间小于等于时间差，则临时输出为假，并设置状态为112。\n     - 如果日出开始时间大于0秒且当前时间减去日出时间加上日出开始时间小于等于时间差，则临时输出为真，并设置状态为113。\n     - 如果日出停止时间大于0秒且当前时间减去日出时间减去日出停止时间小于等于时间差，则临时输出为假，并设置状态为114。\n     - 如果日落开始时间大于0秒且当前时间减去日落时间加上日落开始时间小于等于时间差，则临时输出为真，并设置状态为115。\n     - 如果日落停止时间大于0秒且当前时间减去日落时间减去日落停止时间小于等于时间差，则临时输出为假，并设置状态为116。\n\n  -- REGION 手动控制\n     使用手动控制模块处理临时输出。手动控制模块的输入包括使能、启动、停止和手动控制信号。最终输出信号由手动控制模块决定。\n\n  -- REGION 状态更新\n     如果手动控制模块的状态大于100，则将其状态值赋给输出状态。", "name": "TIMER_EXT"}