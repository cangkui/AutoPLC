{"variables": [], "instructions": [], "planning": "- 概述\n该功能块名为 `DLOG_REAL`，用于处理实数值的数据记录。它通过一个状态机（`CASE` 语句）来处理不同的操作，包括数据列的添加、数据的格式化以及根据增量（`DELTA`）条件触发数据记录请求。\n\n- 变量定义\n代码中定义了以下几类变量：\n  - `VAR_IN_OUT`：`X`，一个派生类型 `DLOG_DATA`，用于存储数据记录的相关信息。\n  - `VAR_INPUT`：`VALUE`（实数值）、`N`（格式化参数）、`D`（小数分隔符，默认为逗号）、`COLUMN`（列名）、`DELTA`（增量阈值）。\n  - `VAR`：`UCB`（派生类型 `UNI_CIRCULAR_BUFFER`，用于处理循环缓冲区操作）、`id`（标识符）、`delta_last`（上一次的增量值）、`value_last`（上一次的值）。\n\n- 主逻辑部分\n  -- REGION CASE x.ADD_COM\n    该区域通过 `CASE` 语句根据 `x.ADD_COM` 的值执行不同的操作：\n    - **01**：\n      - 将 `X.ID_MAX` 增加 1。\n      - 设置 `id` 为固定值 `WORD#16#0201`。\n    - **02**：\n      - 将 `COLUMN` 的值赋给 `X.UCB.D_STRING`，表示列名。\n      - 设置 `X.UCB.D_HEAD` 为 `id`。\n      - 设置 `X.UCB.D_MODE` 为 1，表示模式。\n      - 调用 `UCB` 功能块，将 `X.UCB` 作为输入，处理循环缓冲区操作。\n    - **03**：\n      - 使用 `OSCAT_BASIC.REAL_TO_STRF` 函数将 `value_last` 格式化为字符串，并赋给 `X.UCB.D_STRING`。\n      - 设置 `X.UCB.D_HEAD` 为 `id`。\n      - 设置 `X.UCB.D_MODE` 为 1。\n      - 调用 `UCB` 功能块，将 `X.UCB` 作为输入，处理循环缓冲区操作。\n      - 更新 `delta_last` 为 `value_last`。\n    - **04**：\n      - 如果 `DELTA` 不为 0，检查 `VALUE` 是否超出 `delta_last` 的增量范围（`delta_last - DELTA` 到 `delta_last + DELTA`）。\n      - 如果超出范围，将 `X.ADD_DATA_REQ` 设置为 `TRUE`，表示需要添加数据，并更新 `delta_last` 为 `VALUE`。\n  -- REGION 更新 value_last\n    在 `CASE` 语句结束后，将 `value_last` 更新为当前的 `VALUE`，以便在下一个周期中使用。", "name": "DLOG_REAL"}