{"variables": [], "instructions": [], "planning": "- 概述\n  这段代码是一个使用SCL编写的功能块，名为“GEN_SQR”，用于生成一个方波信号。该方波的周期、幅值、偏移量、占空比和延迟时间可以通过输入参数进行配置。输出包括一个布尔信号Q和一个实数值Out，分别表示方波的状态和当前输出值。\n\n- 变量定义\n  代码中定义了以下几类变量：\n  - 输入变量：周期时间（PT）、幅值（AM）、偏移量（OS）、占空比（DC）、延迟时间（DL）。\n  - 输出变量：方波状态（Q）、当前输出值（Out）。\n  - 内部变量：当前时间（tx）、上一次时间（last）、初始化标志（init）。\n\n- 主逻辑部分\n  -- REGION 初始化检查\n     首先，代码检查占空比（DC）是否为0或1。如果是0，则输出设置为最小值（-AM * 0.5 + OS），并将Q设置为FALSE。如果是1，则输出设置为最大值（AM * 0.5 + OS），并将Q设置为TRUE。这两种情况都会直接返回，不再执行后续逻辑。\n\n  -- REGION 参数处理\n     接下来，代码对延迟时间（DL）和占空比（DC）进行处理，确保它们的值在0到1之间。如果参数小于0，则将其调整为1减去该值。这是通过MODR函数实现的，该函数用于取模运算。\n\n  -- REGION 初始化\n     如果功能块尚未初始化（init为FALSE），则进行初始化操作。将init设置为TRUE，并记录当前时间（last）和初始化时间（tx）。\n\n  -- REGION 周期检查\n     代码检查当前时间（tx）是否超过周期时间（PT）。如果超过，则更新上一次时间（last）并重置当前时间（tx）。这是为了确保时间计算在周期内进行。\n\n  -- REGION 方波生成\n     根据延迟时间（DL）和占空比（DC）的值，代码生成方波信号。如果延迟时间和占空比的总和超过周期时间，则方波的上升沿和下降沿会根据时间进行调整。否则，方波的上升沿和下降沿会根据延迟时间和占空比直接生成。\n     - 如果当前时间（tx）大于等于延迟时间和占空比的总和减去周期时间，则输出设置为最小值（-AM * 0.5 + OS），并将Q设置为FALSE。\n     - 如果当前时间（tx）大于等于延迟时间，则输出设置为最大值（AM * 0.5 + OS），并将Q设置为TRUE。\n     - 如果延迟时间和占空比的总和不超过周期时间，则方波的上升沿和下降沿会根据延迟时间和占空比直接生成。\n\n- 总结\n  该功能块通过周期时间、幅值、偏移量、占空比和延迟时间等参数，生成一个可配置的方波信号。代码通过时间计算和条件判断，确保方波的生成符合输入参数的要求。", "name": "GEN_SQR"}