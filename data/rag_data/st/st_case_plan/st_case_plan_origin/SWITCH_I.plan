{"variables": [], "instructions": [], "planning": "- 概述\n该功能块名为 `SWITCH_I`，用于处理开关逻辑，包括去抖动、重新配置和最大开启时间控制。它通过输入信号 `set`、`in` 和 `rst` 来控制输出信号 `Q`，并支持去抖动时间 `T_debounce`、重新配置时间 `T_reconfig` 和最大开启时间 `T_on_max` 的配置。\n\n- 变量定义\n代码中定义了以下几类变量：\n - 输入变量：`set`（设置信号）、`in`（输入信号）、`rst`（复位信号）、`T_debounce`（去抖动时间）、`T_reconfig`（重新配置时间）、`T_on_max`（最大开启时间）。\n - 输出变量：`Q`（输出信号）。\n - 内部变量：`state`（状态机状态）、`edge`（输入信号的边缘检测）、`r_edge`（重新配置后的边缘检测）、`T_on`（开启时间记录）、`tx`（当前时间）。\n\n- 主逻辑部分\n-- REGION 初始化与时间获取\n   首先，通过 `OSCAT_BASIC.T_PLC_MS()` 获取当前时间，并将其转换为 `TIME` 类型存储在 `tx` 中。\n\n-- REGION 设置与复位逻辑\n   如果 `set` 信号为真且 `rst` 信号为假，则将输出 `Q` 设置为真，并记录当前时间到 `T_on`。如果 `rst` 信号为真，则将输出 `Q` 设置为假。\n\n-- REGION 去抖动逻辑\n   如果输入信号 `in` 与 `edge` 不同（即检测到边缘变化），并且当前状态 `state` 不为 1，则将状态 `state` 设置为 1，并记录当前时间到 `T_on`。如果状态 `state` 为 1，并且当前时间 `tx` 减去去抖动时间 `T_debounce` 大于等于 `T_on`，则将状态 `state` 设置为 2。在状态 2 中，如果 `r_edge` 与 `in` 不同，则翻转输出 `Q`。\n\n-- REGION 重新配置逻辑\n   如果状态 `state` 为 2，并且当前时间 `tx` 减去重新配置时间 `T_reconfig` 大于等于 `T_on`，则将 `r_edge` 设置为 `in`，完成重新配置。\n\n-- REGION 最大开启时间控制\n   如果输出 `Q` 为真，并且最大开启时间 `T_on_max` 大于 0 毫秒，并且当前时间 `tx` 大于等于 `T_on + T_on_max`，则将输出 `Q` 设置为假，强制关闭输出。\n\n-- REGION 边缘检测更新\n   最后，将输入信号 `in` 的值更新到 `edge`，用于下一个周期的边缘检测。", "name": "SWITCH_I"}