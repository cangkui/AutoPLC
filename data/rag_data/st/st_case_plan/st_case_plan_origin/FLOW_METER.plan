{"variables": [], "instructions": [], "planning": "- 概述\n  该功能块 `FLOW_METER` 用于计算流量。它通过输入速度 `VX` 和使能信号 `E` 来计算流量 `F`，并支持脉冲模式和复位功能。流量计算基于积分器 `int1`，并根据更新时间 `UPDATE_TIME` 定期更新输出。\n\n- 变量定义\n  代码中定义了以下几类变量：\n  - 输入变量：速度 `VX`、使能信号 `E`、复位信号 `RST`、脉冲模式 `PULSE_MODE`、更新时间 `UPDATE_TIME`。\n  - 输出变量：流量 `F`。\n  - 输入输出变量：积分值 `X` 和计数器 `Y`。\n  - 内部变量：时间变量 `tx` 和 `tl`、积分器 `int1`、初始化标志 `init`、上一次使能信号 `e_last`、临时变量 `tmp`、上一次的 `X` 和 `Y` 值 `x_last` 和 `y_last`。\n\n- 主逻辑部分\n  -- REGION 初始化\n    在功能块第一次运行时，初始化内部变量。设置 `init` 为 `TRUE`，记录当前时间 `tl`，并保存 `X` 和 `Y` 的初始值。同时，设置积分器 `int1` 的增益 `K` 为 `2.7777777777777777E-4`（用于单位转换）。\n  \n  -- REGION 积分器更新\n    积分器 `int1` 的使能信号由 `E`、`RST` 和 `PULSE_MODE` 决定。如果 `RST` 或 `PULSE_MODE` 为 `TRUE`，则积分器不工作。否则，积分器根据输入速度 `VX` 更新积分值 `X`。\n\n  -- REGION 复位处理\n    如果 `RST` 为 `TRUE`，则重置 `X` 和 `Y` 为 `0`，并更新 `tl`、`x_last` 和 `y_last`。\n\n  -- REGION 脉冲模式处理\n    如果 `E` 和 `PULSE_MODE` 都为 `TRUE`，则在 `E` 的上升沿（即 `E` 从 `FALSE` 变为 `TRUE`）时，将 `VX` 的值累加到 `X` 中。\n\n  -- REGION 计数器更新\n    如果 `X` 的值大于 `1.0`，则将 `X` 的整数部分累加到 `Y` 中，并将 `X` 的小数部分保留。\n\n  -- REGION 流量计算\n    根据当前时间 `tx` 和上一次更新时间 `tl` 的差值，计算流量 `F`。流量计算公式为：\n    \\[\n    F = \\frac{(Y - y_{\\text{last}}) + (X - x_{\\text{last}})}{tx - tl} \\times 3.6 \\times 10^6\n    \\]\n    其中，`3.6E6` 是单位转换系数。计算完成后，更新 `y_last`、`x_last` 和 `tl`。", "name": "FLOW_METER"}