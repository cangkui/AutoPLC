{"variables": [], "instructions": [], "planning": "- 概述\n这段代码实现了一个PI控制器功能块（`CTRL_PI`），用于控制系统的输出。它结合了比例积分（PI）控制和输出限制功能，支持手动和自动模式切换。该功能块通过计算设定值与实际值的偏差，应用PI控制算法，并最终输出控制信号。\n\n- 变量定义\n代码中定义了以下几类变量：\n - 输入变量：实际值（`ACT`）、设定值（`SET`）、设定值上限（`SUP`）、偏移量（`OFS`）、手动输入值（`M_I`）、手动模式（`MAN`）、复位（`RST`）、比例增益（`KP`）、积分增益（`KI`）、输出下限（`LL`）、输出上限（`LH`）。\n - 输出变量：控制输出（`Y`）、偏差值（`DIFF`）、限制标志（`LIM`）。\n - 内部变量：`pi`（PI控制功能块实例）、`co`（输出控制功能块实例）。\n\n- 主逻辑部分\n-- REGION 偏差计算\n   首先，计算设定值（`SET`）与实际值（`ACT`）之间的偏差（`DIFF`）。如果提供了设定值上限（`SUP`），则偏差计算会考虑该上限值。偏差计算通过调用`CTRL_IN`函数实现，结果存储在`DIFF`变量中。\n\n-- REGION PI控制\n   使用偏差值（`DIFF`）作为输入，调用PI控制功能块（`pi`）。PI控制功能块接收以下参数：\n   - 输入偏差（`in`）：即`DIFF`。\n   - 比例增益（`kp`）：由输入参数`KP`提供。\n   - 积分增益（`ki`）：由输入参数`KI`提供。\n   - 输出下限（`lim_l`）：由输入参数`LL`提供。\n   - 输出上限（`lim_h`）：由输入参数`LH`提供。\n   - 复位信号（`rst`）：由输入参数`RST`提供。\n   PI控制功能块计算出控制输出（`pi.Y`），并将其传递给输出控制功能块。\n\n-- REGION 输出控制\n   调用输出控制功能块（`co`），接收以下参数：\n   - 控制输入（`ci`）：即`pi.Y`。\n   - 偏移量（`OFFSET`）：由输入参数`OFS`提供。\n   - 手动输入值（`man_in`）：由输入参数`M_I`提供。\n   - 输出下限（`lim_l`）：由输入参数`LL`提供。\n   - 输出上限（`lim_h`）：由输入参数`LH`提供。\n   - 手动模式（`MANUAL`）：由输入参数`MAN`提供。\n   输出控制功能块根据手动模式的状态决定是否使用手动输入值（`M_I`）或PI控制输出（`pi.Y`）。最终输出（`co.Y`）被赋值给功能块的输出变量`Y`，同时输出限制标志（`co.LIM`）被赋值给`LIM`。\n\n-- REGION 输出结果\n   功能块的最终输出包括：\n   - 控制输出（`Y`）：经过PI控制和输出限制处理后的控制信号。\n   - 偏差值（`DIFF`）：设定值与实际值之间的偏差。\n   - 限制标志（`LIM`）：指示输出是否达到上限或下限。\n\n- 总结\n该功能块实现了一个完整的PI控制器，支持手动和自动模式切换，并提供了输出限制功能。通过计算偏差、应用PI控制算法以及处理输出限制，功能块能够生成稳定的控制信号，适用于各种控制系统场景。", "name": "CTRL_PI"}