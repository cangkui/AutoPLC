

以下是三角波信号发生器的算法流程思维链描述：

1. 初始化阶段：
- 调用QRY_CINT函数获取当前循环中断OB的周期时间（tempCycleTime）和相位信息（tempCyclePhase）
- 检测OB是否可用（QRY_CINT返回值和tempCycleStatus判断）

2. 错误处理分支：
- 若获取时间失败（tempReadTimeStatus≠0）→设置QRY_CINT错误状态
- 若OB不可用（tempCycleStatus异常）→设置OB不可用错误
- 错误状态下输出值置零并立即返回

3. 运行逻辑（无错误时）：
   a. 复位处理：
   - 当reset信号激活时重置计数器statCounter和输出值

   b. 周期累计：
   - 将OB调用间隔时间转换为秒单位累加到计数器
   - 使用MOD运算保持计数器在周期范围内（0 ≤ statCounter < periode）

   c. 相位补偿：
   - 将用户设置的相位偏移转换为整数并与计数器相加
   - 再次使用MOD运算确保相位偏移后的值仍在周期范围内

   d. 波形生成：
   - 通过分段线性公式计算三角波瞬时值：
     1. 用斜率(SLOPE=4)构建上升/下降沿
     2. 使用绝对值运算实现波形反转
     3. 应用振幅缩放和垂直偏移调整

4. 最终输出：
- 叠加用户设置的偏移量offset
- 更新状态标志为正常完成
- 始终强制ENO为true（不使用标准错误机制）

注：该算法通过循环中断OB的固有周期特性实现时间驱动，statCounter的MOD运算保证了波形的周期性，相位补偿机制允许运行时动态调整波形起始点。