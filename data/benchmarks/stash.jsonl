{"title": "PLC Function and Data Definitions for Door Lock and Timer Management", "description": "This code defines multiple user-defined data types, data blocks, and functions for managing timers, door lock states, and related diagnostics in a programmable logic controller (PLC) system. It includes functionality for generating pulses, changing timer states, checking timer status, and controlling door lock states based on various input signals and conditions. The data blocks store timer values, door lock configurations, and diagnostic information. The functions implement operations such as starting, resetting, and checking timers, as well as handling door lock state changes and generating pulses for input signals.", "type": "PLC Code (Functions, Data Types, Data Blocks)", "name": "", "input": [{"name": "new_state", "type": "Int", "description": "New state value for TimerStateChange function to change the actual state in case it's different", "function": "TimerStateChange"}, {"name": "Timer_Nr", "type": "Int", "description": "Timer number used to identify the specific timer in functions like TimerStart, TimerReset, TimerCheck, TimerElapsed, and TimerTON", "function": "TimerStart,TimerReset,TimerCheck,TimerElapsed,TimerTON"}, {"name": "Time", "type": "Int", "description": "Time value in seconds multiplied by 10 for setting the initial time of a timer in the TimerStart function", "function": "TimerStart"}, {"name": "TimerNr", "type": "Int", "description": "Timer number used to identify the specific timer in the TimerTON function for operations related to timer start, reset, and elapsed check", "function": "TimerTON"}, {"name": "IN", "type": "Bool", "description": "Input boolean value in the TimerTON function used to control timer start and reset operations based on its state", "function": "TimerTON"}, {"name": "In_Var", "type": "Bool", "description": "Input variable from which the positive and negative pulses are generated in the fc_pulse function", "function": "fc_pulse"}, {"name": "p_dst_state", "type": "Int", "description": "Desired destination state for the state change operation in the fc_StateChange function", "function": "fc_StateChange"}, {"name": "i_pos", "type": "Int", "description": "Position index (1 for Belader, 2 for Entlader) used in the fc_tuerverriegelungen function for door lock state management", "function": "fc_tuerverriegelungen"}, {"name": "i_side", "type": "Int", "description": "Side index (1 for Rechts, 2 for Links) used in the fc_tuerverriegelungen function for door lock state management", "function": "fc_tuerverriegelungen"}, {"name": "IN_P1", "type": "BOOL", "description": "Not used in the provided code but could be related to an input signal for a process, similar to other input signals in other functions", "function": ""}, {"name": "OUT_P1", "type": "BOOL", "description": "Not used in the provided code but could be related to an output signal for a process, similar to other output signals in other functions", "function": ""}, {"name": "IN_P2", "type": "BOOL", "description": "Not used in the provided code but could be related to an input signal for a process, similar to other input signals in other functions", "function": ""}, {"name": "OUT_P2", "type": "BOOL", "description": "Not used in the provided code but could be related to an output signal for a process, similar to other output signals in other functions", "function": ""}], "output": [{"name": "OUT", "type": "Bool", "description": "Output boolean value in the TimerTON function indicating whether the timer has elapsed or not", "function": "TimerTON"}, {"name": "Pulse_pos_Var", "type": "Bool", "description": "Output variable of the positive pulse generated in the fc_pulse function", "function": "fc_pulse"}, {"name": "Pulse_neg_Var", "type": "Bool", "description": "Output variable of the negative pulse generated in the fc_pulse function", "function": "fc_pulse"}], "in/out": [{"name": "actual_state", "type": "Int", "description": "Current state variable that can be updated to a new state in the TimerStateChange function", "function": "TimerStateChange"}, {"name": "type_fc_pulse_Var", "type": "Struct", "description": "Structure variable of type type_fc_pulse used to store and update pulse-related flags and output variables in the fc_pulse function", "function": "fc_pulse", "fields": [{"name": "Pulse_pos_Var", "type": "Bool", "description": "Output variable of the positive pulse"}, {"name": "Pulse_neg_Var", "type": "Bool", "description": "Output variable of the negative pulse"}, {"name": "Edge_flag_pos", "type": "Bool", "description": "Memory flag of the positive pulse. Assignment by call of the FC_Pulse"}, {"name": "Edge_flag_neg", "type": "Bool", "description": "Memory flag of the negative pulse. Assignment by call of the FC_Pulse"}]}, {"name": "p_state", "type": "Int", "description": "Current state variable that can be updated to a desired destination state in the fc_StateChange function", "function": "fc_StateChange"}, {"name": "Tuerverriegelung", "type": "Struct", "description": "Structure variable of type typ_tuerverriegelungen used to manage door lock states, input signals, and related information in the fc_tuerverriegelungen function", "function": "fc_tuerverriegelungen", "fields": [{"name": "State", "type": "Array[0..1, 0..1] of Int", "description": "State Status"}, {"name": "Bedientaster", "type": "Array[0..1, 0..1] of typ_Bedienung_Tuer", "description": "Bedientaster"}, {"name": "Meldeausgang", "type": "Array[0..1, 0..1] of Struct", "description": "Meldeausgänge von Euchner Verriegelung", "fields": [{"name": "OD_Monitoring", "type": "Bool", "description": "Meldeausgang Türstellung. Griffmodul im Schalterkopf eingeführt"}, {"name": "OL_Lock_active", "type": "Bool", "description": "Meldeausgang Zuhaltung. Bei aktiver Zuhaltung eingeschaltet."}, {"name": "OI_Diagnostic", "type": "Bool", "description": "Meldeausgang Diagnose. Im Fehlerfall eingeschaltet"}]}, {"name": "Tuer_Anf_activ", "type": "Array[0..1, 0..1] of Bool", "description": "Zustand der Tüanforderung Aktiv oder nicht"}, {"name": "Anlageteil_gestoppt", "type": "Array[0..1, 0..1] of Bool", "description": "Freigabe von Extern. Anlage gestoppt"}, {"name": "Zwangsoefnung", "type": "Array[0..1, 0..1] of Bool", "description": "Q.Zwangsöffnung"}, {"name": "ZwangsoefnungsVerz", "type": "Array[0..1, 0..1] of Int", "description": "Zeitverzoegerung für Zwangsöffnung"}, {"name": "VerriegelungLOCK", "type": "Array[0..1, 0..1] of Bool", "description": "Q.Tür Verriegelung"}, {"name": "SFDOOR_Q", "type": "Array[0..1, 0..1] of Bool", "description": "Türsicherheitsschalter geschlossen"}, {"name": "ESTOP1_Q", "type": "Array[0..1, 0..1] of Bool", "description": "ESTOP1.Q Signal des Not-Aus"}, {"name": "ESTOP_ACK_REQ", "type": "Array[0..1, 0..1] of Bool", "description": "Quittieranforderung des Not-Aus"}, {"name": "LMTakt", "type": "Bool", "description": "Takt für Leuchtmelder"}]}], "return_value": [{"name": "TimerCheck", "type": "Int", "description": "Returns the current state of the specified timer (0 = Off, 1 = Running, 2 = Held, 3 = Elapsed) in the TimerCheck function", "function": "TimerCheck"}, {"name": "TimerElapsed", "type": "Bool", "description": "Returns a boolean indicating whether the specified timer has reached the elapsed state (state 3) in the TimerElapsed function", "function": "TimerElapsed"}], "userDefinedTypes": [{"name": "type_fc_pulse", "type": "Struct", "description": "User-defined data type for variables related to pulse generation", "version": "0.1", "fields": [{"name": "Pulse_pos_Var", "type": "Bool", "description": "Output variable of the positive pulse"}, {"name": "Pulse_neg_Var", "type": "Bool", "description": "Output variable of the negative pulse"}, {"name": "Edge_flag_pos", "type": "Bool", "description": "Memory flag of the positive pulse. Assignment by call of the FC_Pulse"}, {"name": "Edge_flag_neg", "type": "Bool", "description": "Memory flag of the negative pulse. Assignment by call of the FC_Pulse"}]}, {"name": "typ_Timers_UDT", "type": "Struct", "description": "User-defined data type for timer states and related information", "version": "0.1", "fields": [{"name": "state", "type": "Int", "description": "current state of the timer (0: Off, 1: Running, 2: Held, 3: Elapsed)"}, {"name": "init_time", "type": "Int", "description": "initial time for the timer in 100ms"}, {"name": "cur_time", "type": "Int", "description": "currently elapsed time for this timer"}, {"name": "time_elapsed", "type": "Bool", "description": "true: timer has completed / false: timer is running or stopped"}]}, {"name": "typ_Bedienung_Tuer", "type": "Struct", "description": "User-defined data type for door operation related buttons and indicators", "version": "0.1", "fields": [{"name": "S_Anfordern", "type": "Bool", "description": "Taster Tür Anfordern"}, {"name": "S_NA_Reset", "type": "Bool", "description": "Taster Not-Halt Reset"}, {"name": "LM_Anfordern", "type": "Bool", "description": "Leuchtmelder Tür Anfordern"}, {"name": "LM_NA_Reset", "type": "Bool", "description": "Leuchtmelder Not-Halt Reset"}, {"name": "fc_pulse_S_Anfordern", "type": "type_fc_pulse", "description": "Structure of type type_fc_pulse for pulse generation related to S_Anfordern button", "fields": [{"name": "Pulse_pos_Var", "type": "Bool", "description": "Output variable of the positive pulse"}, {"name": "Pulse_neg_Var", "type": "Bool", "description": "Output variable of the negative pulse"}, {"name": "Edge_flag_pos", "type": "Bool", "description": "Memory flag of the positive pulse. Assignment by call of the FC_Pulse"}, {"name": "Edge_flag_neg", "type": "Bool", "description": "Memory flag of the negative pulse. Assignment by call of the FC_Pulse"}]}, {"name": "fc_pulse_S_NA_Reset", "type": "type_fc_pulse", "description": "Structure of type type_fc_pulse for pulse generation related to S_NA_Reset button", "fields": [{"name": "Pulse_pos_Var", "type": "Bool", "description": "Output variable of the positive pulse"}, {"name": "Pulse_neg_Var", "type": "Bool", "description": "Output variable of the negative pulse"}, {"name": "Edge_flag_pos", "type": "Bool", "description": "Memory flag of the positive pulse. Assignment by call of the FC_Pulse"}, {"name": "Edge_flag_neg", "type": "Bool", "description": "Memory flag of the negative pulse. Assignment by call of the FC_Pulse"}]}]}, {"name": "typ_PUT_GET", "type": "Struct", "description": "User-defined data type for PUT and GET operation related variables and toggle bits", "version": "0.1", "fields": [{"name": "PUT", "type": "Struct", "description": "Variablen für die PUT Anweisung", "fields": [{"name": "start", "type": "Bool", "description": ""}, {"name": "done", "type": "Bool", "description": ""}, {"name": "memDoneStat", "type": "Word", "description": ""}, {"name": "error", "type": "Bool", "description": ""}, {"name": "status", "type": "Word", "description": ""}, {"name": "memErrStatus", "type": "Word", "description": ""}]}, {"name": "GET", "type": "Struct", "description": "Variablen für die GET Anweisung", "fields": [{"name": "start", "type": "Bool", "description": ""}, {"name": "done", "type": "Bool", "description": ""}, {"name": "memDoneStat", "type": "Word", "description": ""}, {"name": "error", "type": "Bool", "description": ""}, {"name": "status", "type": "Word", "description": ""}, {"name": "memErrStatus", "type": "Word", "description": ""}]}, {"name": "PUT_Tooglebit", "type": "Bool", "description": "Tooglebit Variable die gesendet wird"}, {"name": "GET_Tooglebit", "type": "Bool", "description": "Tooglebit Variable die empfangen wird (Wird ausgewertet)"}]}], {"name": "type_DIAG_FDBACK", "type": "Struct", "description": "User-defined data type for diagnostic feedback byte and related bit statuses", "version": "0.1", "fields": [{"name": "FDBACK_DIAG", "type": "Byte", "description": "Diagnosebyte"}, {"name": "Bit_0_ERROR", "type": "Bool", "description": "Rücklesefehler oder falsche Rücklesezeit eingestellt (= Zustand von ERROR)"}, {"name": "Bit_1_QBAD_FIO", "type": "Bool", "description": "Passivierung der vom Ausgang Q angesteuerten F‑Peripherie/des Kanals "}, {"name": "Bit_2_error_perm_0", "type": "Bool", "description": "nach Rücklesefehler: Rückleseeingang hat permanent Signalzustand 0"}, {"name": "Bit_3_Res3", "type": "Bool", "description": "Reserve"}, {"name": "Bit_4_Res4", "type": "Bool", "description": "Reserve"}, {"name": "Bit_5_error_ACK_perm_1", "type": "Bool", "description": "bei Rücklesefehler: Eingang ACK hat permanent Signalzustand 1"}, {"name": "Bit_6_ACK_REQ", "type": "Bool", "description": "Quittierung erforderlich (= Zustand von ACK_REQ)"}, {"name": "Bit_7_Q", "type": "Bool", "description": "Zustand Ausgang Q"}]}, {"name": "type_DIAG_ESTOP1", "type": "Struct", "description": "User-defined data type for ESTOP1 diagnostic byte and related bit statuses", "version": "0.1", "fields": [{"name": "ESTOP1_DIAG", "type": "Byte", "description": "Diagnosebyte"}, {"name": "Bit_0_error_TIM_DEL", "type": "Bool", "description": "falsche Verzögerungszeit TIM_DEL eingestellt"}, {"name": "Bit_1_Res1", "type": "Bool", "description": "Reserve"}, {"name": "Bit_2_Res2", "type": "Bool", "description": "Reserve"}, {"name": "Bit_3_Res3", "type": "Bool", "description": "Reserve"}, {"name": "Bit_4_error_NH/NA_aktiv", "type": "Bool", "description": "Quittierung nicht möglich, da NOT-HALT/NOT-AUS noch aktiv"}, {"name": "Bit_5_error_ACK_perm_1", "type": "Bool", "description": "bei fehlender Freigabe: Eingang ACK hat permanent Signalzustand 1"}, {"name": "Bit_6_ACK_REQ", "type": "Bool", "description": "Quittierung erforderlich (= Zustand von ACK_REQ)"}, {"name": "Bit_7_Q", "type": "Bool", "description": "Zustand Ausgang Q"}]}, {"name": "type_DIAG_SFDOOR", "type": "Struct", "description": "User-defined data type for SFDOOR diagnostic byte and related bit statuses", "version": "0.1", "fields": [{"name": "SFDOOR_DIAG", "type": "Byte", "description": "Diagnosebyte"}, {"name": "Bit_0_Res0", "type": "Bool", "description": "Reserve"}, {"name": "Bit_1_IN1-2_Missing_False", "type": "Bool", "description": "Schutztür wurde bei OPEN_NEC = 1 nach Anlauf des F‑Systems nicht vollständig geöffnet, geöffnete Schutztür wurde nicht vollständig geöffnet, Verdrahtungsfehler, Positionsschalter defekt, Positionsschalter falsch justiert. Dies bedeutet, dass es bei der Schutztür einen Defekt oder eine Fehlfunktion geben könnte, die zu einem fehlerhaften Zustand führen kann. Beispielsweise kann die fehlende oder unvollständige Öffnung der Schutztür die Sicherheit der Anlage beeinträchtigen, da der Zugang zu gefährlichen Teilen der Anlage möglicherweise nicht wie erwartet kontrolliert wird. Ein Verdrahtungsfehler könnte dazu führen, dass die Signale, die die Schutztür steuern und überwachen, nicht korrekt übertragen werden, während ein defekter oder falsch justierter Positionsschalter die Genauigkeit der Überprüfung der Schutztürposition beeinträchtigt. Die Überprüfung dieses Bits ist daher wichtig, um die Integrität und Sicherheit der Anlage zu gewährleisten und eventuelle Fehler frühzeitig zu erkennen und zu beheben."}]}}